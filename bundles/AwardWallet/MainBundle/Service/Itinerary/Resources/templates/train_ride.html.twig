{% extends "@Module/Itinerary/Resources/templates/itinerary.html.twig" %}

{% block title %}
    {% if edit|default(false) %}
        {{ 'train_ride.edit'|trans([], 'trips') }}
    {% else %}
        {{ 'train_ride.add'|trans([], 'trips') }}
    {% endif %}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {% if not webpack|default(false) %}
        <script>
            require(['jquery-boot', 'pages/itinerary/form'], function ($, ItineraryForm) {
                $(document).ready(function() {
                    new ItineraryForm({
                        formContainer  : '#{{ form.vars.full_name }}',
                        template       : '#segmentTemplate',
                        autocompleteField: 'Station',
                        blockContainer : '#addedSegments',
                        block          : '.segment',
                        companyField: {id: 'carrier', kind: 4}
                    }).init();
                })
            })
        </script>
    {% else %}
         <script>
            window.trainRideFormContainer = '#{{ form.vars.full_name }}';
        </script>
        {{ encore_entry_script_tags('train-ride', null, '_default', {'defer': true}) }}
    {% endif %}
{% endblock %}

{% block main_form %}
    {{- form_start(form, {
        'attr': {
            'data-files': files|json_encode,
            'class': 'main-form',
            'novalidate': 'true',
            'id': form.vars.full_name
        }
    }) -}}
    {{- form_widget(form, {'noSubmit': true}) -}}
    {{ block('submit_button') }}
    {{- form_end(form) -}}
    <script id="segmentTemplate" type="text/plain">{{ form_row(form.segments.vars.prototype) }}</script>
{% endblock %}
