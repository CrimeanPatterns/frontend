{% import "@AwardWalletMain/TwigMacros/environment.html.twig" as environmentMacros %}
{% set MOBILE_NAV = true %}
{% set MAIN_BODY_CLASSES = {
    'manual-hidden': true,
    'responsive': true,
}|merge(MAIN_BODY_CLASSES|default({})) %}
{% extends app.user is not null ? "@AwardWalletMain/Layout/common.html.twig" : "@AwardWalletMain/Layout/not_logged.html.twig" %}
{% import "@AwardWalletMain/TwigMacros/recaptcha.html.twig" as recaptcha %}

{% block meta %}
    {{ parent() }}
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, viewport-fit=cover">
{% endblock %}

{% block title %}{{ 'award-flight-research-tool'|trans|desc("Award Flight Research Tool") }}{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    {{ encore_entry_link_tags('flight-search') }}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {{ encore_entry_script_tags('trans/' ~ app.request.locale) }}
    {{ encore_entry_script_tags('flight-search') }}
{% endblock %}

{% block body_left_widgets %}
    {{ widget_render('left_top') }}
    {{ widget_render('credit_card_tools_zone') }}
    {{ widget_render('left_bottom') }}
{% endblock %}

{% block content %}
    <script id="data" type="application/json">{{ data|raw }}</script>
    <main id="content"></main>

    {% if is_granted('ROLE_STAFF') %}
    {# temporary for debug info #}
    <div id="devMenu" class="devMenu">
        <menu>
            <div><label><input id="debugMode" type="checkbox"> debug</label></div>
        </menu>
    </div>
    <style>
        .flight-search-debug-label {
            width: auto !important;
            position: absolute;
            top: -5px;
            right: 10px;
        }

        .f-airline:after {
            display: block;
            font-size: 11px;
            text-align: right;
        }

        .airline-o:after {
            content: 'OperatingAirline';
        }

        .airline-a:after {
            content: 'Airline';
        }

        .airline-p:after {
            content: 'Provider';
        }

        .flight-search-debug-id div {
            font-size: 75%;
            line-height: 12px;
        }
        .flight-search-debug-id a:hover {
            color: red;
        }
    </style>
    <style id="debugStyle">
        .f-airline, .flight-search-debug-id {
            display: none;
        }
    </style>

    <script>
        require(['jquery-boot'], function() {
            jQuery('body').on('change', '#debugMode', function() {
                if ($(this).prop('checked')) {
                    $('#debugStyle').replaceWith(`<style id="debugStyle"></style>`);
                } else {
                    $('#debugStyle').replaceWith(`
                        <style id="debugStyle">
                            .f-airline, .flight-search-debug-id {
                                display: none;
                            }
                        </style>
                    `);
                }
            });
        });
    </script>
    {# /debug #}
    {% endif %}

{% endblock %}
