{% set title = "FlightInfo statistics" %}
{% extends '@AwardWalletMain/Manager/layout.html.twig' %}
{% import _self as macros %}

{% block content %}
    <style type="text/css">
        table {
            border-collapse: collapse;
        }
        table td {
            border: lightgray solid 1px;
            padding: 7px;
        }
        thead td {
            font-weight: bold;
        }
        .navigation {
            padding: 20px 0 0 0;
        }
    </style>

    <a href="{{ url('aw_manager_flightinfo_index', {year: year, month: month, day: day}) }}">Dashboard</a>

    <hr size="2"/>

    <h1>
        Statistics for {{ headerDate }}
    </h1>

    {{ macros.navigation(year, month, day, days, minYear, maxYear) }}

    <hr size="1"><br/>

    {% if data|length %}
        <table>
            <thead>
            <tr>
                <td>Service</td><td>New</td><td>OK</td><td>API Error</td><td>Auth Error</td>
            </tr>
            </thead>
            <tbody>
            {% for service, row in data %}
                <tr>
                    <td>{{ service }}</td>
                    <td>{{ row[0] }}</td>
                    <td>{{ row[1] }}</td>
                    <td>{{ row[2] }}</td>
                    <td>{{ row[3] }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% endif %}

    <br/><hr size="1">

    {{ macros.navigation(year, month, day, days, minYear, maxYear) }}

    {% macro navigation(year, month, day, days, minYear, maxYear)%}
        <br/>
        <table>
            <tbody>
            <tr>
                <td bgcolor="gray"></td>
                <td>
                    <a href="?">Today</a>
                </td>
            </tr>
            <tr>
                <td bgcolor="gray">Year</td>
                <td>
                    {% for y in minYear .. maxYear %}{% if y == year %}<b>{{ y }}</b>{% else %}<a href="?year={{ y }}&month=1">{{ y }}</a>{% endif %} {% if not loop.last %}&middot;{% endif %} {% endfor %}
                </td>
            </tr>
            <tr>
                <td bgcolor="gray">Month</td>
                <td>
                    {% if not month %}<b>All</b>{% else %}<a href="?year={{ year }}&month=0">All</a>{% endif %} &middot;
                    {% for m in 1..12 %}{% if m == month %}<b>{{ m }}</b>{% else %}<a href="?year={{ year }}&month={{ m }}">{{ m }}</a>{% endif %} {% if not loop.last %}&middot;{% endif %} {% endfor %}
                </td>
            </tr>
            <tr>
                <td bgcolor="gray">Day</td>
                <td>
                    {% if not day %}<b>All</b>{% else %}<a href="?year={{ year }}&month={{ month }}&day={{ 0 }}">All</a>{% endif %} &middot;
                    {% for d in 1..days %}{% if d == day %}<b>{{ d }}</b>{% else %}<a href="?year={{ year }}&month={{ month }}&day={{ d }}">{{ d }}</a>{% endif %} {% if not loop.last %}&middot;{% endif %} {% endfor %}
                </td>
            </tr>
            </tbody>
        </table>
        <br/>
    {% endmacro %}
{% endblock %}